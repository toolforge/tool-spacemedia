<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" data-bs-theme="dark">
  <head th:replace="_header :: common_header(~{::title},~{})">
    <title th:text="Spacemedia + ' - ' + ${org.name}"></title>
  </head>
  <body>
    <nav th:replace="_header :: navbar"></nav>
    <h2 th:text="${org.name}"></h2>
    <ul th:replace="_media :: tabs(${tab})"></ul>
    <!-- Medias tabs -->
    <div th:if="${medias}">
	    <nav th:replace="_media :: pagination_nav(${medias})"></nav>
	    <table class="table table-sm table-hover">
	      <thead class="thead-dark">
		      <tr>
		        <th>Media</th>
		        <th>Title</th>
		        <th>Date</th>
		        <th>Description</th>
		        <th th:if="'missing' != ${tab} and 'missing/images' != ${tab} and 'missing/videos' != ${tab}">Commons</th>
		        <th th:if="'ignored' == ${tab}">Reason</th>
		      <tr>
	      </thead>
	      <tbody>
		      <tr th:each="media : ${medias}">
		        <td>
		          <a th:href="${org.getSourceUrl(media)}" class="imagelink">
		            <img th:src="${media.PreviewUrl}" width="210px" th:alt="${media.PreviewUrl}" />
		            <img th:if="${media.video}" class="cornerimage" width="80px" src="/Antu_videoclip-amarok.svg" alt="" />
		            <img th:if="${media.audio}" class="cornerimage" width="80px" src="/Antu_audio-volume-high.svg" alt="" />
		          </a>
                  <a th:href="@{/{id}/rest/refreshmedia/{mid}(id=${org.id},mid=${media.idUsedInOrg})}" target="_blank">
                    <img width="24" height="24" th:alt="'refresh ' + ${media.idUsedInOrg}" th:src="@{/Gtk-refresh.svg}">
                  </a>
                  <a th:href="@{/{id}/rest/uploadmedia/{mid}(id=${org.id},mid=${media.idUsedInOrg})}" target="_blank" th:if="${org.uploadEnabled}">
                    <img width="24" height="24" th:alt="'upload ' + ${media.idUsedInOrg}" th:src="@{/Wlm-icon-upload-green.svg}">
                  </a>
		          <div th:if="'missing' == ${tab} or 'missing/images' == ${tab} or 'missing/videos' == ${tab}" th:each="asset : ${media.assetsToUpload}">
		          	<a th:href="@{/{id}/rest/wiki/{sha1}(id=${org.id},sha1=${asset})}" target="_blank">
		          		<img width="24" height="24" th:alt="'wikihtml ' + ${asset}" th:src="@{/Emblem-search.svg}">
		          	</a>
		          	<a th:href="@{/{id}/rest/wikicode/{sha1}(id=${org.id},sha1=${asset})}" target="_blank">
		          		<img width="24" height="24" th:alt="'wikicode ' + ${asset}" th:src="@{/Curly_brackets_icon.svg}">
		          	</a>
		          	<a th:href="@{/{id}/rest/upload/{sha1}(id=${org.id},sha1=${asset})}" target="_blank" th:if="${org.uploadEnabled}">
		          		<img width="24" height="24" th:alt="'upload ' + ${asset}" th:src="@{/Wlm-icon-upload-red.svg}">
		          	</a>
		          </div>
		        </td>
		        <td>
		          <a th:text="${media.title}"></a>
                  <a th:href="@{/{id}/rest/uploadbytitle/{title}(id=${org.id},title=${media.title})}" target="_blank" th:if="${org.uploadEnabled} and 'missing' == ${tab}">
                    <img width="24" height="24" th:alt="'upload ' + ${media.title}" th:src="@{/Wlm-icon-upload-green.svg}">
                  </a>
                  <a th:href="@{/{id}/rest/uploadimagesbytitle/{title}(id=${org.id},title=${media.title})}" target="_blank" th:if="${org.uploadEnabled} and 'missing/images' == ${tab}">
                    <img width="24" height="24" th:alt="'upload ' + ${media.title}" th:src="@{/Wlm-icon-upload-green.svg}">
                  </a>
                  <a th:href="@{/{id}/rest/uploadvideosbytitle/{title}(id=${org.id},title=${media.title})}" target="_blank" th:if="${org.uploadEnabled} and 'missing/videos' == ${tab}">
                    <img width="24" height="24" th:alt="'upload ' + ${media.title}" th:src="@{/Wlm-icon-upload-green.svg}">
                  </a>
		        </td>
		        <td>
		          <a th:text="${media.localDate}"></a>
                  <a th:href="@{/{id}/rest/uploadbydate/{date}(id=${org.id},date=${media.localDate})}" target="_blank" th:if="${org.uploadEnabled} and 'missing' == ${tab}">
                    <img width="24" height="24" th:alt="'upload ' + ${media.localDate}" th:src="@{/Wlm-icon-upload-green.svg}">
                  </a>
                  <a th:href="@{/{id}/rest/uploadimagesbydate/{date}(id=${org.id},date=${media.localDate})}" target="_blank" th:if="${org.uploadEnabled} and 'missing/images' == ${tab}">
                    <img width="24" height="24" th:alt="'upload ' + ${media.localDate}" th:src="@{/Wlm-icon-upload-green.svg}">
                  </a>
                  <a th:href="@{/{id}/rest/uploadvideosbydate/{date}(id=${org.id},date=${media.localDate})}" target="_blank" th:if="${org.uploadEnabled} and 'missing/videos' == ${tab}">
                    <img width="24" height="24" th:alt="'upload ' + ${media.localDate}" th:src="@{/Wlm-icon-upload-green.svg}">
                  </a>
		        </td>
		        <td th:utext="${#strings.abbreviate(media.description,2000)}"></td>
		        <td th:if="'missing' != ${tab} and 'missing/images' != ${tab} and 'missing/videos' != ${tab}">
		          <div th:each="file : ${media.allCommonsFileNames}">
		            <a th:text="${file}" th:href="'https://commons.wikimedia.org/wiki/File:' + ${file}"></a><br>
		          </div>
		        </td>
		        <td th:if="'ignored' == ${tab}" th:text="${media.ignoredReason}">
		        </td>
		      </tr>
	      </tbody>
	    </table>
	    <nav th:replace="_media :: pagination_nav(${medias})"></nav>
    </div>
    <!-- Problems tab -->
    <div th:if="${problems}">
	    <nav th:replace="_media :: pagination_nav(${problems})"></nav>
	    <table class="table table-sm table-hover">
	      <thead class="thead-dark">
		      <tr>
		        <th>URL</th>
		        <th>Problem</th>
		      <tr>
	      </thead>
	      <tbody>
		      <tr th:each="problem : ${problems}">
		        <td><a th:text="${problem.problematicUrl}" th:href="${problem.problematicUrl}"></a></td>
		        <td th:text="${problem.errorMessage}"></td>
		      </tr>
	      </tbody>
	    </table>
	    <nav th:replace="_media :: pagination_nav(${problems})"></nav>
    </div>
    <!-- Top terms tab -->
    <div th:if="${topterms}">
	    <table class="table table-sm table-hover">
	      <thead class="thead-dark">
		      <tr>
		        <th>Term</th>
		        <th>Occurrences</th>
		      <tr>
	      </thead>
	      <tbody>
		      <tr th:each="topterm : ${topterms}">
		        <td>
		          <a th:text="${topterm.termtext.utf8ToString()}"
		             th:href="@{/{id}/search?q={term}(id=${org.id},term=${topterm.termtext.utf8ToString()})}">
		          </a>
		        </td>
		        <td th:text="${topterm.docFreq}"></td>
		      </tr>
	      </tbody>
	    </table>
    </div>
    <div th:replace="_header :: scripts"></div>
  </body>
</html>